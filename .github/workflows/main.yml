# Nome da nossa "Esteira"
name: üçî Pipeline do Card√°pio

# Quando ela deve rodar?
# "on: push" significa: "toda vez que algu√©m enviar uma mudan√ßa (commit)"
on:
  push:
    branches:
      - main  # Apenas na branch principal

# Permiss√µes que a esteira precisa para publicar o site
permissions:
  contents: read
  pages: write
  id-token: write

# Os "est√°gios" (Jobs) da nossa pipeline
jobs:
  # ----------------------------------------------------
  # EST√ÅGIO 1: CI (Inspe√ß√£o de Qualidade)
  # ----------------------------------------------------
  build:
    name: üïµÔ∏è Inspecionar (CI)
    runs-on: ubuntu-latest # A "mesa de trabalho" √© um computador Linux

    steps:
    # 1. Pega o c√≥digo do reposit√≥rio (o "card√°pio")
    - name: 1. Pegar o c√≥digo
      uses: actions/checkout@v4

    # 2. SIMULA√á√ÉO: Um teste simples (poderia ser "verificar ortografia")
    - name: 2. Rodar "testes" (Simula√ß√£o)
      run: |
        echo "Iniciando inspe√ß√£o do card√°pio..."
        sleep 5 # Simula um teste demorando 5s
        echo "Inspe√ß√£o de qualidade aprovada!"

    # 3. Prepara o "pacote" (artefato) para o pr√≥ximo est√°gio
    - name: 3. Preparar pacote para entrega
      uses: actions/upload-pages-artifact@v3
      with:
        # Envia tudo da pasta principal
        path: '.'

  # ----------------------------------------------------
  # EST√ÅGIO 2: CD (Entrega Expressa)
  # ----------------------------------------------------
  deploy:
    name: üöÄ Entregar (CD)
    needs: build # ‚ùóÔ∏è S√ì RODA DEPOIS QUE O "build" PASSAR

    # Configura√ß√µes para publicar no GitHub Pages
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    runs-on: ubuntu-latest

    steps:
    # 1. Publica o "pacote" (que o 'build' preparou) no site
    - name: 1. Publicar o novo card√°pio no site
      id: deployment
      uses: actions/deploy-pages@v4